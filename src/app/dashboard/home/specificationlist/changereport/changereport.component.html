<button class="close" mat-button (click)="onNoClick($event)" style="float: right;">X</button>
<h2 mat-dialog-title>Uredi izvještaj za - {{associate_record.Organizationunit.Name}} - {{associate_record.E_month}}/{{associate_record.E_year}} - {{GetStatusString()}}</h2>
<mat-dialog-content [formGroup]="form">
    <div>
        <h2>Promijeni postavke izvještaja od - {{GetAssociateName()}}</h2>
    </div>
    <div class="form-group">
        <label id="lbl_payment_type" style="margin-right: 15px;">Odaberite vrstu isplate</label>
        <mat-radio-group
        aria-labelledby="lbl_payment_type"
        formControlName="PaymentType">
            <mat-radio-button value="1">NET</mat-radio-button>
            <mat-radio-button value="2">Račun</mat-radio-button>
        </mat-radio-group>
        <mat-error *ngIf="form.controls['PaymentType'].hasError('required')">Odabir je obavezan</mat-error>
    </div>
    <hr />
    <div *ngIf="form.controls['PaymentType'].value === '2'">
        <h2 id="lbl_invoice">Detalji računa</h2>
        <div class="form-group">
            <app-file-upload formControlName="INVFile" [progress]="progress_inv" (fileadded)="fileadded_inv($event)"></app-file-upload>
            <div class="invalid-feedback" style="display: block">
              <ng-container *ngIf="hasError('INVFile', 'required') && IsInvOnDisk === false">Ovo polje je obavezno</ng-container>
              <ng-container *ngIf="hasError('INVFile', 'requiredFileType')">Samo je pdf dopušten!</ng-container>
            </div>
            <div fxLayout="row">
                <div fxFlex="70">
                </div>
                <div fxFlex="30">        
                    <button style="margin-top: 15px; margin-right: 15px; margin-bottom: 15px; float:right" type="button" mat-raised-button class="u-margin-l-8" [disabled]="(IsInvOnDisk === false)" (click)="downloadFile($event, 1)">
                        Pregledaj račun
                    </button>
                </div>
            </div>
        </div>
        <hr />
    </div>
    <mat-slide-toggle formControlName="PN_Enabled">Putni Nalog</mat-slide-toggle>
    <hr />
    <div *ngIf="form.controls['PN_Enabled'].value === true">
        <h2 id="lbl_pn">Detalji putnog naloga</h2>
        <mat-form-field >
            <input matInput
                    placeholder="Iznos"
                    formControlName="PNAmount"
                    type="number" 
                    appTwoDigitDecimaNumber>
            <mat-error *ngIf="form.controls['PNAmount'].hasError('required')">Iznos je obavezan</mat-error>
        </mat-form-field>
        <div class="form-group">
            <app-file-upload formControlName="PNFile" [progress]="progress_pn" (fileadded)="fileadded_pn($event)"></app-file-upload>
            <div class="invalid-feedback" style="display: block">
              <ng-container *ngIf="hasError('PNFile', 'required') && IsPNOnDisk === false">Ovo polje je obavezno</ng-container>
              <ng-container *ngIf="hasError('PNFile', 'requiredFileType')">Samo je pdf dopušten!</ng-container>
            </div>
            <div fxLayout="row">
                <div fxFlex="70">
                </div>
                <div fxFlex="30">        
                    <button style="margin-top: 15px; margin-right: 15px; margin-bottom: 15px; float:right" type="button" mat-raised-button class="u-margin-l-8" [disabled]="(IsPNOnDisk === false)" (click)="downloadFile($event, 2)">
                        Pregledaj putni nalog
                    </button>
                </div>
            </div>
        </div>
        <hr />
    </div>
    <div fxLayout="row">
        <mat-form-field style="width: 100%;">
            <mat-label>Komentar</mat-label>
            <textarea matInput formControlName="AspiraComment"  placeholder="Ovdje možete ostaviti vaš komentar"></textarea>
          </mat-form-field>
    </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button class="mat-raised-button mar10p u-margin-l-8"
    (click)="onNoClick($event)">
            Zatvori
    </button>
    <button type="button" mat-raised-button class="mat-primary u-margin-l-8 mar10p" [disabled]="!form.valid || (form.controls['PaymentType'].value === '2' && IsInvOnDisk === false) || (form.controls['PN_Enabled'].value === true && IsPNOnDisk === false)"
            (click)="save($event)">
        Snimi
    </button>
</mat-dialog-actions>